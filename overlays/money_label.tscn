[gd_scene load_steps=5 format=2]

[ext_resource path="res://font/Awake/Awake.ttf" type="DynamicFontData" id=1]
[ext_resource path="res://overlays/63523__florian-reinke__money4.wav" type="AudioStream" id=2]

[sub_resource type="DynamicFont" id=1]
size = 32
outline_size = 1
outline_color = Color( 0, 0, 0, 1 )
font_data = ExtResource( 1 )

[sub_resource type="GDScript" id=2]
script/source = "extends RichTextLabel

var money := 0
var daily_earnings := []


func _ready():
  money = GameLogic.get_player_money()
  format_money()
  EventHub.connect(\"money_updated\", self, \"_on_money_updated\")
  EventHub.connect(\"money_reset\", self, \"_on_money_reset\")


func _on_money_reset(new_value):
  money = new_value
  format_money()


func _on_money_updated(new_value):
  var difference = new_value - money
  _on_add_money(difference)


func format_money(effect = \"\"):
  set_bbcode(\"[right]\" + effect + \"$\" + str(money))


func _on_add_money(addition : float):
# warning-ignore:narrowing_conversion
  money += round(addition)
  var color_string
  if addition > 0:
    color_string = \"[color=#5dff67]\"
  else:
    color_string = \"[color=red]\"

  format_money(\"[wave]\" + color_string)
  $AudioStreamPlayer.play()


func _on_AudioStreamPlayer_finished():
  yield(get_tree().create_timer(1.3), \"timeout\")
  format_money()
"

[node name="MoneyLabel" type="RichTextLabel"]
anchor_right = 0.058
margin_left = 809.476
margin_top = 54.2833
margin_right = 959.476
margin_bottom = 84.2833
custom_fonts/normal_font = SubResource( 1 )
bbcode_enabled = true
bbcode_text = "[right][wave]$5000"
text = "$5000"
fit_content_height = true
scroll_active = false
script = SubResource( 2 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource( 2 )
volume_db = -10.0

[connection signal="finished" from="AudioStreamPlayer" to="." method="_on_AudioStreamPlayer_finished"]
